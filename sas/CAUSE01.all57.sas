 /* Update all 57 underlying cause libraries at once. */

%include 'c:/cygwin/home/bqh0/code/sas/connect_setup.sas';
signon cdcjes2;
rsubmit;


OPTIONS LS=132 CAPS SOURCE NOTES noERRORABEND FILEMSGS;
OPTIONS MAUTOSOURCE SASAUTOS='DWJ2.MACROS.LIB';
*PROGRAM UPDATE;
*08/17/1999 UPDATED THE PROGRAM TO KEEP THE STATISTICIANS;
*           FROM UPDATING THE SAS DATASETS;
*01/20/2000 CREATED PROG FOR DATA YEAR 2000;
*02/29/00  ADDED THE WAIT OPTION IN THE LIBNAME STATEMENT;
*          TO CORRECT THE USER ALLOCATION PROBLEM;

%GLOBAL N I S FYR TMPF;


%macro Cause57(fn);
  filename IN "&fn" DISP=SHR WAIT=30;

  DATA _NULL_;
   LENGTH STCODE $2;
   INFILE IN;
   INPUT YEAR $1-4 STATE 5-6;
   STCODE = STATE;
   YR = YEAR;
   CALL SYMPUT('N',STCODE);
   CALL SYMPUT('FYR',YR);
   CNT + 1;
   IF CNT GT 1 THEN DELETE;
  RUN;

  %LET I = &FYR;

  *RETURNS THE STATE NAME AND ABBREVIATION;
  %STATES

  *THIS MACRO WILL CHECK TO SEE IF YOU RAN THIS PROGRAM BY THE;
  *AF APPLICATION IF SO THEN YOU ARE ASSIGNED A TEMPORARY DATA LIBRARY;

  %MACRO DATASET;
   %IF &TMPF = 'SASAF' %THEN
    %DO;
      LIBNAME CAUS&I "DWJ2.CAUS&I..LIBRARY.TEMP" DISP=OLD WAIT=30;
    %END;
   %ELSE
    %DO;
      LIBNAME CAUS&I "DWJ2.CAUS&I..LIBRARY" DISP=OLD WAIT=30;
    %END;
  %MEND DATASET;

  %DATASET


  *READING DATA FROM THE BF19 FILE;
  DATA UC;
   INFILE IN;
   INPUT CAUSE $ 50-54;
  RUN;

  PROC SORT DATA=UC;
   BY CAUSE;
  RUN;


  PROC FREQ DATA=UC;
    TABLES CAUSE / MISSING NOPRINT OUT=CAUS&I..&S&I;
  RUN;
%mend Cause57;


%macro RunEachState;
  /* From tbe2.final.bf19.dataset 2003-07-22 */
  %Cause57('BF19.AKX0111.MEDMER')
  %Cause57('BF19.ALX0131.MEDMER')
  %Cause57('BF19.ARX0122.MEDMER')
  %Cause57('BF19.ASX0101.MEDMERR')
  %Cause57('BF19.AZX0133.MEDMER')
  %Cause57('BF19.CAX0125.MEDMER')
  %Cause57('BF19.COX0120.MEDMER')
  %Cause57('BF19.CTX0119.MEDMER')
  %Cause57('BF19.DCX0117.MEDMER')
  %Cause57('BF19.DEX0116.MEDMER')
  %Cause57('BF19.FLX0125.MEDMER')
  %Cause57('BF19.GAX0159.MEDMER')
  %Cause57('BF19.GUX0103.MEDMERR')
  %Cause57('BF19.HIX0116.MEDMER')
  %Cause57('BF19.IAX0119.MEDMER')
  %Cause57('BF19.IDX0118.MEDMER')
  %Cause57('BF19.ILX0124.MEDMER')
  %Cause57('BF19.INX0130.MEDMER')
  %Cause57('BF19.KSX0148.MEDMER')
  %Cause57('BF19.KYX0124.MEDMER')
  %Cause57('BF19.LAX0119.MEDMER')
  %Cause57('BF19.MAX0120.MEDMER')
  %Cause57('BF19.MDX0119.MEDMER')
  %Cause57('BF19.MEX0125.MEDMER')
  %Cause57('BF19.MIX0131.MEDMER')
  %Cause57('BF19.MNX0118.MEDMER')
  %Cause57('BF19.MOX0130.MEDMER')
  %Cause57('BF19.MPX0104.MEDMERX')
  %Cause57('BF19.MSX0118.MEDMER')
  %Cause57('BF19.MTX0113.MEDMER')
  %Cause57('BF19.NCX0122.MEDMER')
  %Cause57('BF19.NDX0114.MEDMER')
  %Cause57('BF19.NEX0120.MEDMER')
  %Cause57('BF19.NHX0114.MEDMER')
  %Cause57('BF19.NJX0140.MEDMER')
  %Cause57('BF19.NMX0122.MEDMER')
  %Cause57('BF19.NVX0119.MEDMER')
  %Cause57('BF19.NYX0149.MEDMER')
  %Cause57('BF19.OHX0142.MEDMER')
  %Cause57('BF19.OKX0123.MEDMER')
  %Cause57('BF19.ORX0128.MEDMER')
  %Cause57('BF19.PAX0120.MEDMER')
  %Cause57('BF19.PRX0120.MEDMER')
  %Cause57('BF19.RIX0125.MEDMER')
  %Cause57('BF19.SCX0121.MEDMER')
  %Cause57('BF19.SDX0121.MEDMER')
  %Cause57('BF19.TNX0140.MEDMER')
  %Cause57('BF19.TXX0131.MEDMER')
  %Cause57('BF19.UTX0117.MEDMER')
  %Cause57('BF19.VAX0127.MEDMER')
  %Cause57('BF19.VIX0101.MEDMERX')
  %Cause57('BF19.VTX0130.MEDMER')
  %Cause57('BF19.WAX0114.MEDMER')
  %Cause57('BF19.WIX0117.MEDMER')
  %Cause57('BF19.WVX0114.MEDMER')
  %Cause57('BF19.WYX0126.MEDMER')
  %Cause57('BF19.YCX0150.MEDMER')
%mend RunEachState;
%RunEachState;  /* <---semicolon mandatory here or won't endrsubmit */


endrsubmit;
signoff cdcjes2;
